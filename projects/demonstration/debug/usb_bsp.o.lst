   1              		.syntax unified
   2              		.cpu cortex-m4
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"usb_bsp.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.align	2
  19              		.global	USB_OTG_BSP_Init
  20              		.thumb
  21              		.thumb_func
  23              	USB_OTG_BSP_Init:
  24              	.LFB110:
  25              		.file 1 "../usb_bsp.c"
   1:../usb_bsp.c  **** /**
   2:../usb_bsp.c  ****   ******************************************************************************
   3:../usb_bsp.c  ****   * @file    usb_bsp.c
   4:../usb_bsp.c  ****   * @author  MCD Application Team
   5:../usb_bsp.c  ****   * @version V1.0.0
   6:../usb_bsp.c  ****   * @date    19-September-2011
   7:../usb_bsp.c  ****   * @brief   This file is responsible to offer board support package and is 
   8:../usb_bsp.c  ****   *          configurable by user.
   9:../usb_bsp.c  ****   ******************************************************************************
  10:../usb_bsp.c  ****   * @attention
  11:../usb_bsp.c  ****   *
  12:../usb_bsp.c  ****   * THE PRESENT FIRMWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS
  13:../usb_bsp.c  ****   * WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE
  14:../usb_bsp.c  ****   * TIME. AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY
  15:../usb_bsp.c  ****   * DIRECT, INDIRECT OR CONSEQUENTIAL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING
  16:../usb_bsp.c  ****   * FROM THE CONTENT OF SUCH FIRMWARE AND/OR THE USE MADE BY CUSTOMERS OF THE
  17:../usb_bsp.c  ****   * CODING INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS. 
  18:../usb_bsp.c  ****   *
  19:../usb_bsp.c  ****   * <h2><center>&copy; COPYRIGHT 2011 STMicroelectronics</center></h2>
  20:../usb_bsp.c  ****   ******************************************************************************
  21:../usb_bsp.c  ****   */ 
  22:../usb_bsp.c  **** 
  23:../usb_bsp.c  **** /* Includes ------------------------------------------------------------------*/
  24:../usb_bsp.c  **** #include "usb_bsp.h"
  25:../usb_bsp.c  **** #include "usbd_conf.h"
  26:../usb_bsp.c  **** #include "stm32f4_discovery.h"
  27:../usb_bsp.c  **** 
  28:../usb_bsp.c  **** /** @addtogroup STM32_USB_OTG_DEVICE_LIBRARY
  29:../usb_bsp.c  **** * @{
  30:../usb_bsp.c  **** */
  31:../usb_bsp.c  **** 
  32:../usb_bsp.c  **** /** @defgroup USB_BSP
  33:../usb_bsp.c  **** * @brief This file is responsible to offer board support package
  34:../usb_bsp.c  **** * @{
  35:../usb_bsp.c  **** */ 
  36:../usb_bsp.c  **** 
  37:../usb_bsp.c  **** /** @defgroup USB_BSP_Private_Defines
  38:../usb_bsp.c  **** * @{
  39:../usb_bsp.c  **** */ 
  40:../usb_bsp.c  **** /**
  41:../usb_bsp.c  **** * @}
  42:../usb_bsp.c  **** */ 
  43:../usb_bsp.c  **** 
  44:../usb_bsp.c  **** 
  45:../usb_bsp.c  **** /** @defgroup USB_BSP_Private_TypesDefinitions
  46:../usb_bsp.c  **** * @{
  47:../usb_bsp.c  **** */ 
  48:../usb_bsp.c  **** /**
  49:../usb_bsp.c  **** * @}
  50:../usb_bsp.c  **** */ 
  51:../usb_bsp.c  **** 
  52:../usb_bsp.c  **** 
  53:../usb_bsp.c  **** 
  54:../usb_bsp.c  **** 
  55:../usb_bsp.c  **** 
  56:../usb_bsp.c  **** /** @defgroup USB_BSP_Private_Macros
  57:../usb_bsp.c  **** * @{
  58:../usb_bsp.c  **** */ 
  59:../usb_bsp.c  **** /**
  60:../usb_bsp.c  **** * @}
  61:../usb_bsp.c  **** */ 
  62:../usb_bsp.c  **** 
  63:../usb_bsp.c  **** /** @defgroup USBH_BSP_Private_Variables
  64:../usb_bsp.c  **** * @{
  65:../usb_bsp.c  **** */ 
  66:../usb_bsp.c  **** 
  67:../usb_bsp.c  **** /**
  68:../usb_bsp.c  **** * @}
  69:../usb_bsp.c  **** */ 
  70:../usb_bsp.c  **** 
  71:../usb_bsp.c  **** /** @defgroup USBH_BSP_Private_FunctionPrototypes
  72:../usb_bsp.c  **** * @{
  73:../usb_bsp.c  **** */ 
  74:../usb_bsp.c  **** /**
  75:../usb_bsp.c  **** * @}
  76:../usb_bsp.c  **** */ 
  77:../usb_bsp.c  **** 
  78:../usb_bsp.c  **** /** @defgroup USB_BSP_Private_Functions
  79:../usb_bsp.c  **** * @{
  80:../usb_bsp.c  **** */ 
  81:../usb_bsp.c  **** 
  82:../usb_bsp.c  **** 
  83:../usb_bsp.c  **** /**
  84:../usb_bsp.c  **** * @brief  USB_OTG_BSP_Init
  85:../usb_bsp.c  **** *         Initilizes BSP configurations
  86:../usb_bsp.c  **** * @param  None
  87:../usb_bsp.c  **** * @retval None
  88:../usb_bsp.c  **** */
  89:../usb_bsp.c  **** 
  90:../usb_bsp.c  **** void USB_OTG_BSP_Init(USB_OTG_CORE_HANDLE *pdev)
  91:../usb_bsp.c  **** {
  26              		.loc 1 91 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 16
  29              		@ frame_needed = 1, uses_anonymous_args = 0
  30 0000 80B5     		push	{r7, lr}
  31              	.LCFI0:
  32              		.cfi_def_cfa_offset 8
  33              		.cfi_offset 14, -4
  34              		.cfi_offset 7, -8
  35 0002 84B0     		sub	sp, sp, #16
  36              	.LCFI1:
  37              		.cfi_def_cfa_offset 24
  38 0004 00AF     		add	r7, sp, #0
  39              	.LCFI2:
  40              		.cfi_def_cfa_register 7
  41 0006 7860     		str	r0, [r7, #4]
  92:../usb_bsp.c  ****   GPIO_InitTypeDef GPIO_InitStructure;
  93:../usb_bsp.c  **** 
  94:../usb_bsp.c  **** #ifndef USE_ULPI_PHY 
  95:../usb_bsp.c  **** #ifdef USB_OTG_FS_LOW_PWR_MGMT_SUPPORT
  96:../usb_bsp.c  ****   EXTI_InitTypeDef EXTI_InitStructure;
  97:../usb_bsp.c  ****   NVIC_InitTypeDef NVIC_InitStructure; 
  98:../usb_bsp.c  **** #endif  
  99:../usb_bsp.c  **** #endif
 100:../usb_bsp.c  ****   
 101:../usb_bsp.c  ****  
 102:../usb_bsp.c  ****  #ifdef USE_USB_OTG_FS 
 103:../usb_bsp.c  **** 
 104:../usb_bsp.c  ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_GPIOA , ENABLE);  
  42              		.loc 1 104 0
  43 0008 4FF00100 		mov	r0, #1
  44 000c 4FF00101 		mov	r1, #1
  45 0010 FFF7FEFF 		bl	RCC_AHB1PeriphClockCmd
 105:../usb_bsp.c  ****   
 106:../usb_bsp.c  ****   /* Configure SOF VBUS ID DM DP Pins */
 107:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8  | 
  46              		.loc 1 107 0
  47 0014 4FF4D853 		mov	r3, #6912
  48 0018 BB60     		str	r3, [r7, #8]
 108:../usb_bsp.c  ****     GPIO_Pin_9  | 
 109:../usb_bsp.c  ****       GPIO_Pin_11 | 
 110:../usb_bsp.c  ****         GPIO_Pin_12;
 111:../usb_bsp.c  ****   
 112:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
  49              		.loc 1 112 0
  50 001a 4FF00303 		mov	r3, #3
  51 001e 7B73     		strb	r3, [r7, #13]
 113:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
  52              		.loc 1 113 0
  53 0020 4FF00203 		mov	r3, #2
  54 0024 3B73     		strb	r3, [r7, #12]
 114:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
  55              		.loc 1 114 0
  56 0026 4FF00003 		mov	r3, #0
  57 002a BB73     		strb	r3, [r7, #14]
 115:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL ;
  58              		.loc 1 115 0
  59 002c 4FF00003 		mov	r3, #0
  60 0030 FB73     		strb	r3, [r7, #15]
 116:../usb_bsp.c  ****   GPIO_Init(GPIOA, &GPIO_InitStructure);  
  61              		.loc 1 116 0
  62 0032 4FF00000 		mov	r0, #0
  63 0036 C4F20200 		movt	r0, 16386
  64 003a 07F10803 		add	r3, r7, #8
  65 003e 1946     		mov	r1, r3
  66 0040 FFF7FEFF 		bl	GPIO_Init
 117:../usb_bsp.c  ****   
 118:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource8,GPIO_AF_OTG1_FS) ;
  67              		.loc 1 118 0
  68 0044 4FF00000 		mov	r0, #0
  69 0048 C4F20200 		movt	r0, 16386
  70 004c 4FF00801 		mov	r1, #8
  71 0050 4FF00A02 		mov	r2, #10
  72 0054 FFF7FEFF 		bl	GPIO_PinAFConfig
 119:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource9,GPIO_AF_OTG1_FS) ; 
  73              		.loc 1 119 0
  74 0058 4FF00000 		mov	r0, #0
  75 005c C4F20200 		movt	r0, 16386
  76 0060 4FF00901 		mov	r1, #9
  77 0064 4FF00A02 		mov	r2, #10
  78 0068 FFF7FEFF 		bl	GPIO_PinAFConfig
 120:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource11,GPIO_AF_OTG1_FS) ; 
  79              		.loc 1 120 0
  80 006c 4FF00000 		mov	r0, #0
  81 0070 C4F20200 		movt	r0, 16386
  82 0074 4FF00B01 		mov	r1, #11
  83 0078 4FF00A02 		mov	r2, #10
  84 007c FFF7FEFF 		bl	GPIO_PinAFConfig
 121:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource12,GPIO_AF_OTG1_FS) ;
  85              		.loc 1 121 0
  86 0080 4FF00000 		mov	r0, #0
  87 0084 C4F20200 		movt	r0, 16386
  88 0088 4FF00C01 		mov	r1, #12
  89 008c 4FF00A02 		mov	r2, #10
  90 0090 FFF7FEFF 		bl	GPIO_PinAFConfig
 122:../usb_bsp.c  ****   
 123:../usb_bsp.c  ****   /* this for ID line debug */
 124:../usb_bsp.c  ****   
 125:../usb_bsp.c  ****   
 126:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Pin =  GPIO_Pin_10;
  91              		.loc 1 126 0
  92 0094 4FF48063 		mov	r3, #1024
  93 0098 BB60     		str	r3, [r7, #8]
 127:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_OType = GPIO_OType_OD;
  94              		.loc 1 127 0
  95 009a 4FF00103 		mov	r3, #1
  96 009e BB73     		strb	r3, [r7, #14]
 128:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP ;  
  97              		.loc 1 128 0
  98 00a0 4FF00103 		mov	r3, #1
  99 00a4 FB73     		strb	r3, [r7, #15]
 129:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 100              		.loc 1 129 0
 101 00a6 4FF00303 		mov	r3, #3
 102 00aa 7B73     		strb	r3, [r7, #13]
 130:../usb_bsp.c  ****   GPIO_Init(GPIOA, &GPIO_InitStructure);  
 103              		.loc 1 130 0
 104 00ac 4FF00000 		mov	r0, #0
 105 00b0 C4F20200 		movt	r0, 16386
 106 00b4 07F10803 		add	r3, r7, #8
 107 00b8 1946     		mov	r1, r3
 108 00ba FFF7FEFF 		bl	GPIO_Init
 131:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource10,GPIO_AF_OTG1_FS) ;   
 109              		.loc 1 131 0
 110 00be 4FF00000 		mov	r0, #0
 111 00c2 C4F20200 		movt	r0, 16386
 112 00c6 4FF00A01 		mov	r1, #10
 113 00ca 4FF00A02 		mov	r2, #10
 114 00ce FFF7FEFF 		bl	GPIO_PinAFConfig
 132:../usb_bsp.c  **** 
 133:../usb_bsp.c  ****   RCC_APB2PeriphClockCmd(RCC_APB2Periph_SYSCFG, ENABLE);
 115              		.loc 1 133 0
 116 00d2 4FF48040 		mov	r0, #16384
 117 00d6 4FF00101 		mov	r1, #1
 118 00da FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
 134:../usb_bsp.c  ****   RCC_AHB2PeriphClockCmd(RCC_AHB2Periph_OTG_FS, ENABLE) ; 
 119              		.loc 1 134 0
 120 00de 4FF08000 		mov	r0, #128
 121 00e2 4FF00101 		mov	r1, #1
 122 00e6 FFF7FEFF 		bl	RCC_AHB2PeriphClockCmd
 135:../usb_bsp.c  ****  #else // USE_USB_OTG_HS 
 136:../usb_bsp.c  **** 
 137:../usb_bsp.c  ****   #ifdef USE_ULPI_PHY // ULPI
 138:../usb_bsp.c  ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_GPIOA | RCC_AHB1Periph_GPIOB | 
 139:../usb_bsp.c  ****                          RCC_AHB1Periph_GPIOC | RCC_AHB1Periph_GPIOH | 
 140:../usb_bsp.c  ****                            RCC_AHB1Periph_GPIOI, ENABLE);    
 141:../usb_bsp.c  ****   
 142:../usb_bsp.c  ****   
 143:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource3, GPIO_AF_OTG2_HS) ; // D0
 144:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource5, GPIO_AF_OTG2_HS) ; // CLK
 145:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource0, GPIO_AF_OTG2_HS) ; // D1
 146:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource1, GPIO_AF_OTG2_HS) ; // D2
 147:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource5, GPIO_AF_OTG2_HS) ; // D7
 148:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource10,GPIO_AF_OTG2_HS) ; // D3
 149:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource11,GPIO_AF_OTG2_HS) ; // D4
 150:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource12,GPIO_AF_OTG2_HS) ; // D5
 151:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource13,GPIO_AF_OTG2_HS) ; // D6
 152:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOH,GPIO_PinSource4, GPIO_AF_OTG2_HS) ; // NXT
 153:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOI,GPIO_PinSource11,GPIO_AF_OTG2_HS) ; // DIR
 154:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOC,GPIO_PinSource0, GPIO_AF_OTG2_HS) ; // STP
 155:../usb_bsp.c  ****   
 156:../usb_bsp.c  ****   // CLK
 157:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_5 ; 
 158:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 159:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 160:../usb_bsp.c  ****   GPIO_Init(GPIOA, &GPIO_InitStructure);  
 161:../usb_bsp.c  ****   
 162:../usb_bsp.c  ****   // D0
 163:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_3  ; 
 164:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 165:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 166:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 167:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL ;
 168:../usb_bsp.c  ****   GPIO_Init(GPIOA, &GPIO_InitStructure);  
 169:../usb_bsp.c  ****   
 170:../usb_bsp.c  ****   
 171:../usb_bsp.c  ****   
 172:../usb_bsp.c  ****   // D1 D2 D3 D4 D5 D6 D7
 173:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0 | GPIO_Pin_1  |
 174:../usb_bsp.c  ****     GPIO_Pin_5 | GPIO_Pin_10 | 
 175:../usb_bsp.c  ****       GPIO_Pin_11| GPIO_Pin_12 | 
 176:../usb_bsp.c  ****         GPIO_Pin_13 ;
 177:../usb_bsp.c  ****   
 178:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 179:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 180:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 181:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL ;
 182:../usb_bsp.c  ****   GPIO_Init(GPIOB, &GPIO_InitStructure);  
 183:../usb_bsp.c  ****   
 184:../usb_bsp.c  ****   
 185:../usb_bsp.c  ****   // STP
 186:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0  ;
 187:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 188:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 189:../usb_bsp.c  ****   GPIO_Init(GPIOC, &GPIO_InitStructure);  
 190:../usb_bsp.c  ****   
 191:../usb_bsp.c  ****   //NXT  
 192:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_4;
 193:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 194:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 195:../usb_bsp.c  ****   GPIO_Init(GPIOH, &GPIO_InitStructure);  
 196:../usb_bsp.c  ****   
 197:../usb_bsp.c  ****   
 198:../usb_bsp.c  ****   //DIR
 199:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11 ; 
 200:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 201:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 202:../usb_bsp.c  ****   GPIO_Init(GPIOI, &GPIO_InitStructure);  
 203:../usb_bsp.c  ****   
 204:../usb_bsp.c  ****   
 205:../usb_bsp.c  ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_OTG_HS | 
 206:../usb_bsp.c  ****                          RCC_AHB1Periph_OTG_HS_ULPI, ENABLE) ;    
 207:../usb_bsp.c  ****    
 208:../usb_bsp.c  ****   #else
 209:../usb_bsp.c  ****    #ifdef USE_I2C_PHY    
 210:../usb_bsp.c  ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_GPIOB , ENABLE);  
 211:../usb_bsp.c  ****   /* Configure RESET INTN SCL SDA (Phy/I2C) Pins */
 212:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0 | 
 213:../usb_bsp.c  ****     GPIO_Pin_1 | 
 214:../usb_bsp.c  ****       GPIO_Pin_10 | 
 215:../usb_bsp.c  ****         GPIO_Pin_11;
 216:../usb_bsp.c  ****   
 217:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 218:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 219:../usb_bsp.c  ****   GPIO_Init(GPIOB, &GPIO_InitStructure);  
 220:../usb_bsp.c  ****   
 221:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource0,GPIO_AF_OTG2_FS) ; 
 222:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource1,GPIO_AF_OTG2_FS) ; 
 223:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource10,GPIO_AF_OTG2_FS) ; 
 224:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource11,GPIO_AF_OTG2_FS);
 225:../usb_bsp.c  ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_OTG_HS, ENABLE) ;  
 226:../usb_bsp.c  ****   
 227:../usb_bsp.c  ****    #else
 228:../usb_bsp.c  **** 
 229:../usb_bsp.c  ****   RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOB , ENABLE);
 230:../usb_bsp.c  ****   
 231:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_12  | 
 232:../usb_bsp.c  ****     GPIO_Pin_13 |
 233:../usb_bsp.c  ****       GPIO_Pin_14 | 
 234:../usb_bsp.c  ****         GPIO_Pin_15;
 235:../usb_bsp.c  ****   
 236:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 237:../usb_bsp.c  ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 238:../usb_bsp.c  ****   GPIO_Init(GPIOB, &GPIO_InitStructure);  
 239:../usb_bsp.c  ****   
 240:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource12, GPIO_AF_OTG2_FS) ; 
 241:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource13,GPIO_AF_OTG2_FS) ; 
 242:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource14,GPIO_AF_OTG2_FS) ; 
 243:../usb_bsp.c  ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource15,GPIO_AF_OTG2_FS) ;
 244:../usb_bsp.c  ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_OTG_HS, ENABLE) ;  
 245:../usb_bsp.c  ****    #endif  
 246:../usb_bsp.c  ****   #endif // USE_ULPI_PHY
 247:../usb_bsp.c  ****   
 248:../usb_bsp.c  ****  #endif //USB_OTG_HS
 249:../usb_bsp.c  **** 
 250:../usb_bsp.c  ****   
 251:../usb_bsp.c  ****   /* enable the PWR clock */
 252:../usb_bsp.c  ****   RCC_APB1PeriphResetCmd(RCC_APB1Periph_PWR, ENABLE);   
 123              		.loc 1 252 0
 124 00ea 4FF08050 		mov	r0, #268435456
 125 00ee 4FF00101 		mov	r1, #1
 126 00f2 FFF7FEFF 		bl	RCC_APB1PeriphResetCmd
 253:../usb_bsp.c  ****   
 254:../usb_bsp.c  ****   /* Configure the Key button in EXTI mode */
 255:../usb_bsp.c  ****   STM_EVAL_PBInit(BUTTON_USER, BUTTON_MODE_EXTI);
 127              		.loc 1 255 0
 128 00f6 4FF00000 		mov	r0, #0
 129 00fa 4FF00101 		mov	r1, #1
 130 00fe FFF7FEFF 		bl	STM_EVAL_PBInit
 256:../usb_bsp.c  ****   
 257:../usb_bsp.c  **** #ifdef USB_OTG_FS_LOW_PWR_MGMT_SUPPORT
 258:../usb_bsp.c  ****   EXTI_ClearITPendingBit(EXTI_Line18);
 259:../usb_bsp.c  ****   
 260:../usb_bsp.c  ****   EXTI_InitStructure.EXTI_Line = EXTI_Line18; 
 261:../usb_bsp.c  ****   EXTI_InitStructure.EXTI_Mode = EXTI_Mode_Interrupt;
 262:../usb_bsp.c  ****   EXTI_InitStructure.EXTI_Trigger = EXTI_Trigger_Rising;
 263:../usb_bsp.c  ****   EXTI_InitStructure.EXTI_LineCmd = ENABLE;
 264:../usb_bsp.c  ****   EXTI_Init(&EXTI_InitStructure);
 265:../usb_bsp.c  **** 
 266:../usb_bsp.c  ****   EXTI_ClearITPendingBit(EXTI_Line18);   
 267:../usb_bsp.c  **** 
 268:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_FS_WKUP_IRQn;
 269:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
 270:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;
 271:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 272:../usb_bsp.c  ****   NVIC_Init(&NVIC_InitStructure);
 273:../usb_bsp.c  **** 
 274:../usb_bsp.c  ****   EXTI_ClearITPendingBit(EXTI_Line18);    
 275:../usb_bsp.c  **** #endif 
 276:../usb_bsp.c  ****   
 277:../usb_bsp.c  **** #ifdef USB_OTG_HS_LOW_PWR_MGMT_SUPPORT
 278:../usb_bsp.c  ****   EXTI_ClearITPendingBit(EXTI_Line20);
 279:../usb_bsp.c  ****   
 280:../usb_bsp.c  ****   EXTI_InitStructure.EXTI_Line = EXTI_Line20; 
 281:../usb_bsp.c  ****   EXTI_InitStructure.EXTI_Mode = EXTI_Mode_Interrupt;
 282:../usb_bsp.c  ****   EXTI_InitStructure.EXTI_Trigger = EXTI_Trigger_Rising;
 283:../usb_bsp.c  ****   EXTI_InitStructure.EXTI_LineCmd = ENABLE;
 284:../usb_bsp.c  ****   EXTI_Init(&EXTI_InitStructure);
 285:../usb_bsp.c  **** 
 286:../usb_bsp.c  ****   EXTI_ClearITPendingBit(EXTI_Line20);   
 287:../usb_bsp.c  **** 
 288:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_HS_WKUP_IRQn;
 289:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 2;
 290:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 2;
 291:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 292:../usb_bsp.c  ****   NVIC_Init(&NVIC_InitStructure);
 293:../usb_bsp.c  **** 
 294:../usb_bsp.c  ****   EXTI_ClearITPendingBit(EXTI_Line20);    
 295:../usb_bsp.c  **** #endif   
 296:../usb_bsp.c  **** 
 297:../usb_bsp.c  ****   EXTI_ClearITPendingBit(USER_BUTTON_EXTI_LINE);  
 131              		.loc 1 297 0
 132 0102 4FF00100 		mov	r0, #1
 133 0106 FFF7FEFF 		bl	EXTI_ClearITPendingBit
 298:../usb_bsp.c  **** }
 134              		.loc 1 298 0
 135 010a 07F11007 		add	r7, r7, #16
 136 010e BD46     		mov	sp, r7
 137 0110 80BD     		pop	{r7, pc}
 138              		.cfi_endproc
 139              	.LFE110:
 141 0112 00BF     		.align	2
 142              		.global	USB_OTG_BSP_EnableInterrupt
 143              		.thumb
 144              		.thumb_func
 146              	USB_OTG_BSP_EnableInterrupt:
 147              	.LFB111:
 299:../usb_bsp.c  **** /**
 300:../usb_bsp.c  **** * @brief  USB_OTG_BSP_EnableInterrupt
 301:../usb_bsp.c  **** *         Enabele USB Global interrupt
 302:../usb_bsp.c  **** * @param  None
 303:../usb_bsp.c  **** * @retval None
 304:../usb_bsp.c  **** */
 305:../usb_bsp.c  **** void USB_OTG_BSP_EnableInterrupt(USB_OTG_CORE_HANDLE *pdev)
 306:../usb_bsp.c  **** {
 148              		.loc 1 306 0
 149              		.cfi_startproc
 150              		@ args = 0, pretend = 0, frame = 16
 151              		@ frame_needed = 1, uses_anonymous_args = 0
 152 0114 80B5     		push	{r7, lr}
 153              	.LCFI3:
 154              		.cfi_def_cfa_offset 8
 155              		.cfi_offset 14, -4
 156              		.cfi_offset 7, -8
 157 0116 84B0     		sub	sp, sp, #16
 158              	.LCFI4:
 159              		.cfi_def_cfa_offset 24
 160 0118 00AF     		add	r7, sp, #0
 161              	.LCFI5:
 162              		.cfi_def_cfa_register 7
 163 011a 7860     		str	r0, [r7, #4]
 307:../usb_bsp.c  ****   NVIC_InitTypeDef NVIC_InitStructure; 
 308:../usb_bsp.c  ****   
 309:../usb_bsp.c  ****   NVIC_PriorityGroupConfig(NVIC_PriorityGroup_1);
 164              		.loc 1 309 0
 165 011c 4FF4C060 		mov	r0, #1536
 166 0120 FFF7FEFF 		bl	NVIC_PriorityGroupConfig
 310:../usb_bsp.c  **** #ifdef USE_USB_OTG_HS   
 311:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_HS_IRQn;
 312:../usb_bsp.c  **** #else
 313:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_FS_IRQn;  
 167              		.loc 1 313 0
 168 0124 4FF04303 		mov	r3, #67
 169 0128 3B73     		strb	r3, [r7, #12]
 314:../usb_bsp.c  **** #endif
 315:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 1;
 170              		.loc 1 315 0
 171 012a 4FF00103 		mov	r3, #1
 172 012e 7B73     		strb	r3, [r7, #13]
 316:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 3;
 173              		.loc 1 316 0
 174 0130 4FF00303 		mov	r3, #3
 175 0134 BB73     		strb	r3, [r7, #14]
 317:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 176              		.loc 1 317 0
 177 0136 4FF00103 		mov	r3, #1
 178 013a FB73     		strb	r3, [r7, #15]
 318:../usb_bsp.c  ****   NVIC_Init(&NVIC_InitStructure);  
 179              		.loc 1 318 0
 180 013c 07F10C03 		add	r3, r7, #12
 181 0140 1846     		mov	r0, r3
 182 0142 FFF7FEFF 		bl	NVIC_Init
 319:../usb_bsp.c  **** #ifdef USB_OTG_HS_DEDICATED_EP1_ENABLED
 320:../usb_bsp.c  ****   NVIC_PriorityGroupConfig(NVIC_PriorityGroup_1);
 321:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_HS_EP1_OUT_IRQn;
 322:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 1;
 323:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 2;
 324:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 325:../usb_bsp.c  ****   NVIC_Init(&NVIC_InitStructure);  
 326:../usb_bsp.c  ****   
 327:../usb_bsp.c  ****   NVIC_PriorityGroupConfig(NVIC_PriorityGroup_1);
 328:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_HS_EP1_IN_IRQn;
 329:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 1;
 330:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;
 331:../usb_bsp.c  ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 332:../usb_bsp.c  ****   NVIC_Init(&NVIC_InitStructure);   
 333:../usb_bsp.c  **** #endif
 334:../usb_bsp.c  **** }
 183              		.loc 1 334 0
 184 0146 07F11007 		add	r7, r7, #16
 185 014a BD46     		mov	sp, r7
 186 014c 80BD     		pop	{r7, pc}
 187              		.cfi_endproc
 188              	.LFE111:
 190 014e 00BF     		.align	2
 191              		.global	USB_OTG_BSP_uDelay
 192              		.thumb
 193              		.thumb_func
 195              	USB_OTG_BSP_uDelay:
 196              	.LFB112:
 335:../usb_bsp.c  **** /**
 336:../usb_bsp.c  **** * @brief  USB_OTG_BSP_uDelay
 337:../usb_bsp.c  **** *         This function provides delay time in micro sec
 338:../usb_bsp.c  **** * @param  usec : Value of delay required in micro sec
 339:../usb_bsp.c  **** * @retval None
 340:../usb_bsp.c  **** */
 341:../usb_bsp.c  **** void USB_OTG_BSP_uDelay (const uint32_t usec)
 342:../usb_bsp.c  **** {
 197              		.loc 1 342 0
 198              		.cfi_startproc
 199              		@ args = 0, pretend = 0, frame = 16
 200              		@ frame_needed = 1, uses_anonymous_args = 0
 201              		@ link register save eliminated.
 202 0150 80B4     		push	{r7}
 203              	.LCFI6:
 204              		.cfi_def_cfa_offset 4
 205              		.cfi_offset 7, -4
 206 0152 85B0     		sub	sp, sp, #20
 207              	.LCFI7:
 208              		.cfi_def_cfa_offset 24
 209 0154 00AF     		add	r7, sp, #0
 210              	.LCFI8:
 211              		.cfi_def_cfa_register 7
 212 0156 7860     		str	r0, [r7, #4]
 343:../usb_bsp.c  ****   uint32_t count = 0;
 213              		.loc 1 343 0
 214 0158 4FF00003 		mov	r3, #0
 215 015c FB60     		str	r3, [r7, #12]
 344:../usb_bsp.c  ****   const uint32_t utime = (120 * usec / 7);
 216              		.loc 1 344 0
 217 015e 7A68     		ldr	r2, [r7, #4]
 218 0160 1346     		mov	r3, r2
 219 0162 4FEA0313 		lsl	r3, r3, #4
 220 0166 9B1A     		subs	r3, r3, r2
 221 0168 4FEAC303 		lsl	r3, r3, #3
 222 016c 1A46     		mov	r2, r3
 223 016e 44F62513 		movw	r3, #18725
 224 0172 C2F29243 		movt	r3, 9362
 225 0176 A3FB0213 		umull	r1, r3, r3, r2
 226 017a D21A     		subs	r2, r2, r3
 227 017c 4FEA5202 		lsr	r2, r2, #1
 228 0180 9B18     		adds	r3, r3, r2
 229 0182 4FEA9303 		lsr	r3, r3, #2
 230 0186 BB60     		str	r3, [r7, #8]
 231 0188 00E0     		b	.L5
 232              	.L6:
 345:../usb_bsp.c  ****   do
 346:../usb_bsp.c  ****   {
 347:../usb_bsp.c  ****     if ( ++count > utime )
 348:../usb_bsp.c  ****     {
 349:../usb_bsp.c  ****       return ;
 350:../usb_bsp.c  ****     }
 351:../usb_bsp.c  ****   }
 352:../usb_bsp.c  ****   while (1);
 233              		.loc 1 352 0
 234 018a 00BF     		nop
 235              	.L5:
 347:../usb_bsp.c  ****     if ( ++count > utime )
 236              		.loc 1 347 0
 237 018c FB68     		ldr	r3, [r7, #12]
 238 018e 03F10103 		add	r3, r3, #1
 239 0192 FB60     		str	r3, [r7, #12]
 240 0194 FA68     		ldr	r2, [r7, #12]
 241 0196 BB68     		ldr	r3, [r7, #8]
 242 0198 9A42     		cmp	r2, r3
 243 019a F6D9     		bls	.L6
 349:../usb_bsp.c  ****       return ;
 244              		.loc 1 349 0
 245 019c 00BF     		nop
 353:../usb_bsp.c  **** }
 246              		.loc 1 353 0
 247 019e 07F11407 		add	r7, r7, #20
 248 01a2 BD46     		mov	sp, r7
 249 01a4 80BC     		pop	{r7}
 250 01a6 7047     		bx	lr
 251              		.cfi_endproc
 252              	.LFE112:
 254              		.align	2
 255              		.global	USB_OTG_BSP_mDelay
 256              		.thumb
 257              		.thumb_func
 259              	USB_OTG_BSP_mDelay:
 260              	.LFB113:
 354:../usb_bsp.c  **** 
 355:../usb_bsp.c  **** 
 356:../usb_bsp.c  **** /**
 357:../usb_bsp.c  **** * @brief  USB_OTG_BSP_mDelay
 358:../usb_bsp.c  **** *          This function provides delay time in milli sec
 359:../usb_bsp.c  **** * @param  msec : Value of delay required in milli sec
 360:../usb_bsp.c  **** * @retval None
 361:../usb_bsp.c  **** */
 362:../usb_bsp.c  **** void USB_OTG_BSP_mDelay (const uint32_t msec)
 363:../usb_bsp.c  **** {
 261              		.loc 1 363 0
 262              		.cfi_startproc
 263              		@ args = 0, pretend = 0, frame = 8
 264              		@ frame_needed = 1, uses_anonymous_args = 0
 265 01a8 80B5     		push	{r7, lr}
 266              	.LCFI9:
 267              		.cfi_def_cfa_offset 8
 268              		.cfi_offset 14, -4
 269              		.cfi_offset 7, -8
 270 01aa 82B0     		sub	sp, sp, #8
 271              	.LCFI10:
 272              		.cfi_def_cfa_offset 16
 273 01ac 00AF     		add	r7, sp, #0
 274              	.LCFI11:
 275              		.cfi_def_cfa_register 7
 276 01ae 7860     		str	r0, [r7, #4]
 364:../usb_bsp.c  ****   USB_OTG_BSP_uDelay(msec * 1000);   
 277              		.loc 1 364 0
 278 01b0 7B68     		ldr	r3, [r7, #4]
 279 01b2 4FF47A72 		mov	r2, #1000
 280 01b6 02FB03F3 		mul	r3, r2, r3
 281 01ba 1846     		mov	r0, r3
 282 01bc FFF7FEFF 		bl	USB_OTG_BSP_uDelay
 365:../usb_bsp.c  **** }
 283              		.loc 1 365 0
 284 01c0 07F10807 		add	r7, r7, #8
 285 01c4 BD46     		mov	sp, r7
 286 01c6 80BD     		pop	{r7, pc}
 287              		.cfi_endproc
 288              	.LFE113:
 290              	.Letext0:
 291              		.file 2 "/Users/josefvanniekerk/Developer/Cross/arm-cs-tools-2012.03-56-e3f4013-20130305/lib/gcc/a
 292              		.file 3 "/Users/josefvanniekerk/Projects/stm32f4-discovery/projects/demonstration/../../libraries/
 293              		.file 4 "/Users/josefvanniekerk/Projects/stm32f4-discovery/projects/demonstration/../../libraries/
 294              		.file 5 "/Users/josefvanniekerk/Projects/stm32f4-discovery/projects/demonstration/../../libraries/
 295              		.file 6 "/Users/josefvanniekerk/Projects/stm32f4-discovery/projects/demonstration/../../libraries/
 296              		.file 7 "/Users/josefvanniekerk/Projects/stm32f4-discovery/projects/demonstration/../../libraries/
 297              		.file 8 "/Users/josefvanniekerk/Projects/stm32f4-discovery/projects/demonstration/../../utilities/
 298              		.file 9 "/Users/josefvanniekerk/Projects/stm32f4-discovery/projects/demonstration/../../libraries/
DEFINED SYMBOLS
                            *ABS*:0000000000000000 usb_bsp.c
/var/folders/29/q4vqrldx53dd1j615jflh8h40000gn/T//ccP39x5q.s:18     .text:0000000000000000 $t
/var/folders/29/q4vqrldx53dd1j615jflh8h40000gn/T//ccP39x5q.s:23     .text:0000000000000000 USB_OTG_BSP_Init
/var/folders/29/q4vqrldx53dd1j615jflh8h40000gn/T//ccP39x5q.s:146    .text:0000000000000114 USB_OTG_BSP_EnableInterrupt
/var/folders/29/q4vqrldx53dd1j615jflh8h40000gn/T//ccP39x5q.s:195    .text:0000000000000150 USB_OTG_BSP_uDelay
/var/folders/29/q4vqrldx53dd1j615jflh8h40000gn/T//ccP39x5q.s:259    .text:00000000000001a8 USB_OTG_BSP_mDelay
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
RCC_AHB1PeriphClockCmd
GPIO_Init
GPIO_PinAFConfig
RCC_APB2PeriphClockCmd
RCC_AHB2PeriphClockCmd
RCC_APB1PeriphResetCmd
STM_EVAL_PBInit
EXTI_ClearITPendingBit
NVIC_PriorityGroupConfig
NVIC_Init
